<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body> <hr> <p>layout: post title: understanding DDPM date: 2025-09-13 21:24:00 description: a brief but strict understanding to DDPM tags: formatting math related_posts: false categories: AI —</p> <h1 id="ddpm扩散模型梦开始的地方">DDPM：扩散模型梦开始的地方</h1> <h2 id="为什么是-ddpm">为什么是 DDPM</h2> <p>答案很简单：因为最近扩散模型很火，因此为了蹭上一波热度开始了解扩散模型的方向。DDPM作为一个比较经典的扩散模型，具有较为复杂的数学推导。在学习过程中容易出现理论与代码实践切割的情况。因此这篇文章希望能够统一地介绍DDPM的数学原理以及具体的代码实现。</p> <h2 id="直观感受">直观感受</h2> <h3 id="源自非平衡态热力学的启发">源自非平衡态热力学的启发</h3> <p>DDPM的核心思想是模仿物理世界中粒子扩散的过程。例如，一滴墨水在水中逐渐散开，最终均匀分布，这是一个从有序到无序的过程。DDPM通过学习这个过程的逆过程，从完全无序的噪声中逐步恢复出有序、清晰的图案。</p> <h4 id="前向扩散过程">前向扩散过程</h4> <p>这个过程是非平衡热力学中的熵增过程，系统从有序变得无序。在DDPM中，这个过程表现为一张图像和一个高斯噪声按照一定比例混合，形成新的图像，经过多次上述操作后，我们可以得到一张约为完全噪音的图像。</p> <h4 id="反向去噪过程">反向去噪过程</h4> <p>这个过程是前向扩散过程的逆过程，系统从无序变得有序。在DDPM中，这个过程表现为，给模型一张带有噪音的图像，模型尝试生成其中噪音的部分并将其去除。给模型一张纯噪音图像，经过多次去噪，我们就有可能得到一张清晰的图像。</p> <h2 id="数学原理">数学原理</h2> <p>针对上述直观的过程，我们下面进行较为严格的数学推导。</p> <h3 id="加噪与去噪">加噪与去噪</h3> <p>我们首先定义时间步 \(T\) ，这表示我们总共需要加噪，去噪 \(T\) 次之后才能得到一张完全的噪声图像或生成图像。特别地，我们使用 \(x_t\) 表示目前的图像被加噪了多少次。\(x_0\) 表示这是一张没有经过加噪的正常图像，\(x_T\) 表示这是一张经过 \(T\) 次加噪后得到的一张噪声图像。</p> <p>加噪过程的每一步，都只与当前图像有关，而与再之前的图像无关。这说明，加噪过程是一个马尔科夫链。去噪过程我们也假设可以写成一个马尔科夫链。</p> <p>对于加噪过程，DDPM定义为：</p> \[q(x_t|x_{t-1}):=\mathcal{N}(x_t;\sqrt{1-\beta_t}x_{t-1},\beta_t \mathbf{I})\] <p>对于去噪过程，DDPM 定义为：</p> \[p_\theta(x_{t-1}|x_t):=\mathcal{N}（x_{t-1};\mu_\theta(x_t,t),\Sigma_\theta(x_t,t)) \\\] </body></html>